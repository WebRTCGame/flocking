{"filter":false,"title":"fish.js","tooltip":"/src/fish.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":522,"column":13},"end":{"row":522,"column":14},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":10},"end":{"row":522,"column":14},"action":"remove","lines":["affi"]},{"start":{"row":522,"column":10},"end":{"row":522,"column":20},"action":"insert","lines":["affinity()"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":19},"end":{"row":522,"column":20},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":20},"end":{"row":522,"column":21},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":21},"end":{"row":522,"column":22},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":22},"end":{"row":522,"column":23},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":23},"end":{"row":522,"column":24},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":24},"end":{"row":522,"column":25},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":25},"end":{"row":522,"column":26},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":26},"end":{"row":522,"column":27},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":27},"end":{"row":522,"column":28},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":28},"end":{"row":522,"column":29},"action":"insert","lines":["L"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":29},"end":{"row":522,"column":30},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":30},"end":{"row":522,"column":31},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":31},"end":{"row":522,"column":32},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":32},"end":{"row":522,"column":33},"action":"insert","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":32},"end":{"row":522,"column":33},"action":"remove","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":18},"end":{"row":522,"column":19},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":19},"end":{"row":522,"column":20},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":20},"end":{"row":522,"column":21},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":21},"end":{"row":522,"column":22},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":22},"end":{"row":522,"column":23},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":23},"end":{"row":522,"column":24},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":24},"end":{"row":522,"column":25},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":25},"end":{"row":522,"column":26},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":26},"end":{"row":522,"column":27},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":27},"end":{"row":522,"column":28},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":28},"end":{"row":522,"column":29},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":44},"end":{"row":522,"column":45},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":45},"end":{"row":522,"column":46},"action":"insert","lines":["}"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":46},"end":{"row":522,"column":47},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":45},"end":{"row":524,"column":0},"action":"insert","lines":["","\t",""]}]}],[{"group":"doc","deltas":[{"start":{"row":523,"column":1},"end":{"row":533,"column":28},"action":"insert","lines":["\tvar coef = 0;","\tfor (var i in fishList) {","\t\tvar difference = Math.abs(fishList[i].hue - this.hue);","\t\tif (difference > 0.5) {","\t\t\tdifference = 1 - difference;","\t\t}","\t\tcoef += difference;","\t}","\tvar affinity = 1 - (coef / fishList.length);","","\treturn affinity * affinity;"]}]}],[{"group":"doc","deltas":[{"start":{"row":525,"column":46},"end":{"row":525,"column":50},"action":"remove","lines":["this"]},{"start":{"row":525,"column":46},"end":{"row":525,"column":47},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":525,"column":47},"end":{"row":525,"column":48},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":525,"column":48},"end":{"row":525,"column":49},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":525,"column":49},"end":{"row":525,"column":50},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":522,"column":0},"end":{"row":534,"column":2},"action":"remove","lines":["Behaviors.affinity = function(fish,fishList){","\t\tvar coef = 0;","\tfor (var i in fishList) {","\t\tvar difference = Math.abs(fishList[i].hue - fish.hue);","\t\tif (difference > 0.5) {","\t\t\tdifference = 1 - difference;","\t\t}","\t\tcoef += difference;","\t}","\tvar affinity = 1 - (coef / fishList.length);","","\treturn affinity * affinity;","};"]}]}],[{"group":"doc","deltas":[{"start":{"row":123,"column":2},"end":{"row":124,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":124,"column":0},"end":{"row":136,"column":2},"action":"insert","lines":["Behaviors.affinity = function(fish,fishList){","\t\tvar coef = 0;","\tfor (var i in fishList) {","\t\tvar difference = Math.abs(fishList[i].hue - fish.hue);","\t\tif (difference > 0.5) {","\t\t\tdifference = 1 - difference;","\t\t}","\t\tcoef += difference;","\t}","\tvar affinity = 1 - (coef / fishList.length);","","\treturn affinity * affinity;","};"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":16},"end":{"row":322,"column":17},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":17},"end":{"row":322,"column":18},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":16},"end":{"row":322,"column":17},"action":"insert","lines":["B"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":17},"end":{"row":322,"column":18},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":18},"end":{"row":322,"column":19},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":19},"end":{"row":322,"column":20},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":20},"end":{"row":322,"column":21},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":16},"end":{"row":322,"column":21},"action":"remove","lines":["Behav"]},{"start":{"row":322,"column":16},"end":{"row":322,"column":25},"action":"insert","lines":["Behaviors"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":25},"end":{"row":322,"column":26},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":26},"end":{"row":322,"column":27},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":27},"end":{"row":322,"column":28},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":28},"end":{"row":322,"column":29},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":26},"end":{"row":322,"column":29},"action":"remove","lines":["aff"]},{"start":{"row":322,"column":26},"end":{"row":322,"column":36},"action":"insert","lines":["affinity()"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":35},"end":{"row":322,"column":36},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":36},"end":{"row":322,"column":37},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":37},"end":{"row":322,"column":38},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":38},"end":{"row":322,"column":39},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":39},"end":{"row":322,"column":40},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":39},"end":{"row":322,"column":40},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":39},"end":{"row":322,"column":40},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":40},"end":{"row":322,"column":41},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":41},"end":{"row":322,"column":42},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":42},"end":{"row":322,"column":43},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":43},"end":{"row":322,"column":44},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":44},"end":{"row":322,"column":45},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":45},"end":{"row":322,"column":46},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":46},"end":{"row":322,"column":47},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":46},"end":{"row":322,"column":47},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":46},"end":{"row":322,"column":47},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":47},"end":{"row":322,"column":48},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":48},"end":{"row":322,"column":49},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":49},"end":{"row":322,"column":50},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":50},"end":{"row":322,"column":51},"action":"insert","lines":["L"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":45},"end":{"row":322,"column":51},"action":"remove","lines":["shoalL"]},{"start":{"row":322,"column":45},"end":{"row":322,"column":54},"action":"insert","lines":["shoalList"]}]}],[{"group":"doc","deltas":[{"start":{"row":322,"column":55},"end":{"row":322,"column":56},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":535,"column":0},"end":{"row":535,"column":1},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":535,"column":1},"end":{"row":535,"column":2},"action":"insert","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":549,"column":0},"end":{"row":549,"column":1},"action":"insert","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":549,"column":1},"end":{"row":549,"column":2},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":31,"column":0},"end":{"row":136,"column":2},"action":"remove","lines":["var Behaviors = {};","Behaviors.avoid = function(fish, dist) {","\tif (fish.avoidList) {","\t\tfor (var i = 0; i < fish.avoidList; i++) {","\t\t\tvar other = fish.avoidList[i];","\t\t\tif (fish.location.dist(other.location) < dist) {","\t\t\t\tfish.applyForce(other.location.copy().sub(fish.location).mul(-100));","\t\t\t}","\t\t}","\t}","\tif (fish.showBehavior) {","\t\tthis.color = 'blue';","\t}","};","Behaviors.wander = function(fish) {","\tif (Math.random() < 0.05) {","\t\tfish.wandering.rotate(Math.PI * 2 * Math.random());","\t}","\tfish.velocity.add(fish.wandering);","","\tif (Fish.showBehavior) {","\t\tfish.color = \"gray\";","\t}","};","Behaviors.seek = function(fish, target) {","\tvar seek = target.copy().sub(fish.location);","\tseek.normalize();","\tseek.mul(fish.maxspeed);","\tseek.sub(fish.velocity).limit(fish.maxforce);","","\treturn seek;","};","Behaviors.attract = function(fish, body, attractionForce) {","\tvar force = fish.location.copy().sub(body.location);","\tvar distance = force.mag();","\tdistance = distance < 5 ? 5 : distance > 25 ? 25 : distance;","\tforce.normalize();","","\tvar strength = (attractionForce * fish.mass * body.mass) / (distance * distance);","\tforce.mul(strength);","\treturn force;","};","Behaviors.align = function(fish, neighboors) {","\tvar sum = new Vector(0, 0);","","\tif (neighboors.length) {","\t\tfor (var i in neighboors) {","\t\t\tsum.add(neighboors[i].velocity);","\t\t}","\t\tsum.div(neighboors.length);","\t\tsum.normalize();","\t\tsum.mul(fish.maxspeed);","\t\tsum.sub(fish.velocity);","\t\tsum.limit(fish.maxspeed);","\t}","","\treturn sum;","};","Behaviors.separate = function(fish,neighboors,range){","\t\tvar sum = new Vector(0, 0);","","\tif (neighboors.length) {","\t\tfor (var i in neighboors) {","\t\t\tvar d = fish.location.dist(neighboors[i].location);","\t\t\tif (d < range) {","\t\t\t\tvar diff = fish.location.copy().sub(neighboors[i].location);","\t\t\t\tdiff.normalize();","\t\t\t\tdiff.div(d);","\t\t\t\tsum.add(diff);","\t\t\t}","\t\t}","\t\tsum.div(neighboors.length);","\t\tsum.normalize();","\t\tsum.mul(fish.maxspeed);","\t\tsum.sub(fish.velocity);","\t\tsum.limit(fish.maxforce);","\t}","","\treturn sum;","};","Behaviors.cohesion = function(fish,neighboors){","\t\tvar sum = new Vector(0, 0);","","\tif (neighboors.length) {","\t\tfor (var i in neighboors) {","\t\t\tsum.add(neighboors[i].location);","\t\t}","\t\tsum.div(neighboors.length);","\t\treturn Behaviors.seek(fish, sum); //this.seek(sum);","\t}","","\treturn sum;","};","Behaviors.affinity = function(fish,fishList){","\t\tvar coef = 0;","\tfor (var i in fishList) {","\t\tvar difference = Math.abs(fishList[i].hue - fish.hue);","\t\tif (difference > 0.5) {","\t\t\tdifference = 1 - difference;","\t\t}","\t\tcoef += difference;","\t}","\tvar affinity = 1 - (coef / fishList.length);","","\treturn affinity * affinity;","};"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":84},"end":{"row":1,"column":85},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":85},"end":{"row":1,"column":86},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":86},"end":{"row":1,"column":87},"action":"insert","lines":["B"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":87},"end":{"row":1,"column":88},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":88},"end":{"row":1,"column":89},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":89},"end":{"row":1,"column":90},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":90},"end":{"row":1,"column":91},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":91},"end":{"row":1,"column":92},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":92},"end":{"row":1,"column":93},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":93},"end":{"row":1,"column":94},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":93},"end":{"row":1,"column":94},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":92},"end":{"row":1,"column":93},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":92},"end":{"row":1,"column":93},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":93},"end":{"row":1,"column":94},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":94},"end":{"row":1,"column":95},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":95},"end":{"row":1,"column":96},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":96},"end":{"row":1,"column":97},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":97},"end":{"row":1,"column":98},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":98},"end":{"row":1,"column":99},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":99},"end":{"row":1,"column":100},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":100},"end":{"row":1,"column":101},"action":"insert","lines":["e"]}]}]]},"ace":{"folds":[],"scrolltop":4320,"scrollleft":0,"selection":{"start":{"row":272,"column":0},"end":{"row":286,"column":2},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":109,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1417632979826,"hash":"7beab3ce42aa46a3e92a24015326fb8f3a331a46"}